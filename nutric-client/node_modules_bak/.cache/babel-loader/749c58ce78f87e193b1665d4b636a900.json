{"ast":null,"code":"import _objectWithoutProperties from \"/home/ubuntu/workspace/nutric-client/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport { apiCall, setTokenHeader } from '../../services/api';\nimport { SET_CURRENT_USER } from '../actionTypes';\nimport { addError, removeError } from './errors';\nexport function setCurrentUser(user) {\n  return {\n    type: SET_CURRENT_USER,\n    user: user\n  };\n}\nexport function setAuthorizationToken(token) {\n  setTokenHeader(token);\n}\nexport function logout() {\n  return function (dispatch) {\n    localStorage.clear();\n    dispatch(setCurrentUser({}));\n  };\n} //debería ser authExpert\n\nexport function authUser(type, userData) {\n  return function (dispatch) {\n    return new Promise(function (resolve, reject) {\n      return apiCall(\"post\", \"/api/experts/\".concat(type), userData) //ESTO CAMBIA CUANDO ES PATIENT\n      .then(function (_ref) {\n        var token = _ref.token,\n            user = _objectWithoutProperties(_ref, [\"token\"]);\n\n        localStorage.setItem(\"jwtToken\", token);\n        dispatch(setCurrentUser(user));\n        dispatch(removeError);\n        resolve();\n      }).catch(function (err) {\n        dispatch(addError(err.message));\n        reject();\n      });\n    });\n  };\n}","map":{"version":3,"sources":["/home/ubuntu/workspace/nutric-client/src/Main/store/actions/auth.js"],"names":["apiCall","setTokenHeader","SET_CURRENT_USER","addError","removeError","setCurrentUser","user","type","setAuthorizationToken","token","logout","dispatch","localStorage","clear","authUser","userData","Promise","resolve","reject","then","setItem","catch","err","message"],"mappings":";AAAA,SAAQA,OAAR,EAAiBC,cAAjB,QAAsC,oBAAtC;AACA,SAAQC,gBAAR,QAA+B,gBAA/B;AACA,SAAQC,QAAR,EAAkBC,WAAlB,QAAoC,UAApC;AAEA,OAAO,SAASC,cAAT,CAAwBC,IAAxB,EAA6B;AAClC,SAAO;AACLC,IAAAA,IAAI,EAAEL,gBADD;AAELI,IAAAA,IAAI,EAAJA;AAFK,GAAP;AAID;AAED,OAAO,SAASE,qBAAT,CAA+BC,KAA/B,EAAsC;AAC3CR,EAAAA,cAAc,CAACQ,KAAD,CAAd;AACD;AAED,OAAO,SAASC,MAAT,GAAiB;AACtB,SAAO,UAAAC,QAAQ,EAAI;AACjBC,IAAAA,YAAY,CAACC,KAAb;AACAF,IAAAA,QAAQ,CAACN,cAAc,CAAC,EAAD,CAAf,CAAR;AACD,GAHD;AAID,C,CAGD;;AACA,OAAO,SAASS,QAAT,CAAkBP,IAAlB,EAAwBQ,QAAxB,EAAiC;AACtC,SAAO,UAAAJ,QAAQ,EAAI;AACjB,WAAO,IAAIK,OAAJ,CAAY,UAACC,OAAD,EAASC,MAAT,EAAoB;AACrC,aAAOlB,OAAO,CAAC,MAAD,yBAAwBO,IAAxB,GAA+BQ,QAA/B,CAAP,CAAgD;AAAhD,OACJI,IADI,CACC,gBAAoB;AAAA,YAAlBV,KAAkB,QAAlBA,KAAkB;AAAA,YAARH,IAAQ;;AACxBM,QAAAA,YAAY,CAACQ,OAAb,CAAqB,UAArB,EAAgCX,KAAhC;AACAE,QAAAA,QAAQ,CAACN,cAAc,CAACC,IAAD,CAAf,CAAR;AACAK,QAAAA,QAAQ,CAACP,WAAD,CAAR;AACAa,QAAAA,OAAO;AACR,OANI,EAOJI,KAPI,CAOE,UAAAC,GAAG,EAAE;AACVX,QAAAA,QAAQ,CAACR,QAAQ,CAACmB,GAAG,CAACC,OAAL,CAAT,CAAR;AACAL,QAAAA,MAAM;AACP,OAVI,CAAP;AAWD,KAZM,CAAP;AAaD,GAdD;AAeD","sourcesContent":["import {apiCall, setTokenHeader} from '../../services/api';\nimport {SET_CURRENT_USER} from '../actionTypes';\nimport {addError, removeError} from './errors';\n\nexport function setCurrentUser(user){\n  return {\n    type: SET_CURRENT_USER,\n    user\n  };\n}\n\nexport function setAuthorizationToken(token) {\n  setTokenHeader(token);\n}\n\nexport function logout(){\n  return dispatch => {\n    localStorage.clear();\n    dispatch(setCurrentUser({}))\n  }\n}\n\n\n//debería ser authExpert\nexport function authUser(type, userData){\n  return dispatch => {\n    return new Promise((resolve,reject) => {\n      return apiCall(\"post\",`/api/experts/${type}`,userData) //ESTO CAMBIA CUANDO ES PATIENT\n        .then(({token, ...user})=>{\n          localStorage.setItem(\"jwtToken\",token);\n          dispatch(setCurrentUser(user));\n          dispatch(removeError)\n          resolve();\n        })\n        .catch(err=>{\n          dispatch(addError(err.message));\n          reject();\n        })\n    })\n  }\n}"]},"metadata":{},"sourceType":"module"}